% !TEX root = paper.tex

\section{Introduction}
\label{sec:intro}
Blood glucose concentration plays an important role in personal health.
Hyperglycemia (high blood glucose level) results in diabetes, leading to health risks such as pancreatic function failure, immunity reduce and ocular fundus diseases~\cite{bib:DC95:Klein}.
Meanwhile, hypoglycemia (low blood glucose level) also brings complications such as confusion, shakiness, anxiety, and even coma or death if not treated in time~\cite{bib:AJM91:DCCT}.
The International Diabetes Federation (IDF) reports that there were 415 million diabetic patients in 2015 and the number will rise to 642 million by 2040~\cite{bib:IDF15}.
People with diabetes need tight control of their blood glucose concentration to avoid both short-term and long-term physiological complications.
While non-diabetic people normally have adequate self-regulation of blood glucose concentration, they still have the risk of hypoglycemia when taking prolonged exercises, drinking excess amounts of alcohol, having eating disorders, taking certain medicines (\eg certain painkiller and antibiotic), or having pre-diabetes~\cite{bib:JCEM13:Eckert} \cite{bib:NEJM82:Felig}.

While continuous or regular blood glucose monitoring is essential for blood glucose management and beneficial for hyper- and hypoglycemia warning, it can be invasive and inconvenient, especially during daily life.
A standard and direct blood glucose measurement is to collect and analyze a drop of blood by finger pricking, which requires a new prick on the finger for every  observation.
Alternatively, non-invasive (without penetrating the skin) continuous glucose monitoring (CGM) has attracted extensive research leveraging techniques such as thermal infrared spectroscopy, Raman spectroscopy and impedance spectroscopy~\cite{bib:MEP08:Do} \cite{bib:JDST10:Vaddiraju}.
However, most CGM devices are expensive, cumbersome to wear for extended time, complicated in terms of operation/maintenance, and are usually limited to clinical uses, making them unattractive for both diabetic patients and non-diabetic people.

Towards more ubiquitous blood glucose monitoring when traditional CGM devices are unavailable or inconvenient to general users, researchers propose to explore the increasingly rich sensors embedded in commercial fitness wearables and smartphones as a complement.
In addition to the glucose metabolism that is difficult to measure directly, blood glucose also correlates to easily measurable physiological activities such as food and drug intake, energy expenditure, sleep quality and emotional states~\cite{bib:DRCP15:Iwasaki}.
Pioneer works~\cite{bib:EMBC12:Nguyen} \cite{bib:SEMPER16:Ranvier} \cite{bib:JDST14:Sobel} have proposed preliminary systems adopting commodity bio-sensors (\eg ECG electrodes) and fitness wearables (\eg accelerometer and galvanic skin response sensors) to predict blood glucose concentrations and alarm abnormal blood glucose evnts.
Nevertheless, they are validated with limited number of measurements~\cite{bib:SEMPER16:Ranvier} \cite{bib:JDST14:Sobel} or still require complex multi-sensory platforms~\cite{bib:EMBC12:Nguyen} \cite{bib:JDST14:Sobel}.

The target users includes both non-diabetes individuals and type I and type II diabetic patients, which are two main types of diabetes mellitus \cite{bib:Diabetes_mellitus}.
\sysname monitors the blood glucose every 3 minutes, which is a fine-grained interval to track the blood glucose dynamics.
When it detects an abnormal blood glucose event, the user will be reminded to take corresponding treatment (\eg, double-check by finger pricking or using CGM devices).
Note that \sysname is not an alternative of CGMs or the finger sticker, but is a supplement while it is inconvenient for users to take clinic measurement.
For example, assuming an user measuring blood glucose by finger-stick at 9 a.m. and 8 p.m., he can wear \sysname to monitor his blood glucose dynamic in other time.
The blood glucose data predicted by \sysname helps users ameliorate their daily activities (\eg food intakes and exercise), and also assists doctors to make more efficient and comprehensive treatment on patients.

In this work, we design \sysname, the first personalized smartphone-based non-invasive blood glucose monitoring system that detects abnormal blood glucose events by jointly tracking meal, drug and insulin intake, physical activity and sleep quality.
\rev{The target users of current prototype includes both non-diabetes individuals and type I and type II diabetic patients, which are two main types of diabetes mellitus~\cite{bib:Diabetes_mellitus}.
\sysname monitors the blood glucose every 3 min, which is a fine-grained interval to track the blood glucose dynamics.
When it detects an abnormal blood glucose event, it reminds the user to adopt corresponding treatments}.
\sysname exploits recent advances in smartphone-based automatic human activity recognition~\cite{bib:KDDEN11:Kwapisz} and sleep quality measurement~\cite{bib:UbiComp14:Gu} to acquire external factors as input for abnormal blood glucose event detection, making it widely applicable in daily use.
In addition, \sysname comprehensively considers \emph{generic}, \emph{grouped}  and \emph{user-specific} correlations between blood glucose levels and the measurable external factors, which are largely overlooked in previous works.

However, it is challenging to learn effective, accurate and personalized blood glucose models in practice.
While there have been general blood glucose models characterizing universal trends between blood glucose concentration and various external factors~\cite{bib:IJNMBE16:Oviedo}, they have to be adjusted based on user-specific data to account for inter-user differences~\cite{bib:ICMLA13:Bunescu}.
Yet it is often difficult to collect sufficient data to directly build up personalized models~\cite{bib:KDHealth16:Marling}:
\emph{(i)}
A disposable enzyme of glucose sensor embedded in the CGM device is only capable of a few days \cite{bib:CGM_wiki} \cite{bib:CGM_wave}, and most users are unwilling to wear CGM devices frequently due to discomfort.
\emph{(ii)}
Despite their importance, measurements of hyper- and hypoglycemia events are rare compared with normal blood glucose concentrations, making it difficult to accurately detect abnormal blood glucose events.

To take full advantages of the \emph{sparse}, \emph{imbalanced} measurements to build \emph{personalized} blood glucose level models, we first conduct feature extraction from both physiological and temporal data analysis viewpoints. More importantly, we propose \modelname (multi-division deep dynamic recurrent neural network), an efficient learning paradigm that extracts general blood glucose level relevant features and preserves user-specific characteristics.
Our \modelname advances previous recurrent neural network (RNN) structures on blood glucose inference from two perspectives.
On the one hand, it replaces the single hidden layer with multiple deep stacked layers to describe complex, multi-scale dynamics in blood glucose metabolism.
On the other hand, it leverages a group-shared input layer to extract distinctive feature representations within the same group (\ie non-diabetic, type I and type II diabetic), and adds a personalized output layer to capture individual differences.
In short, \modelname can be regarded as both a deep hierarchical RNN architectures, \rev{which is a combination of single user division and grouped user division learning}.
Evaluations on the blood glucose dataset composed of 112 users with six days or more collection data show that our novel \modelname framework outperforms both generic learning (\ie ignoring inter-user differences) and personalized learning (due to lack of measurements), and also achieves notably higher inference accuracy than conventional shallow learning algorithms.

The key contributions of this work are summarized as follows.
\begin{itemize}
  \item
  To the best of our knowledge, \sysname is the first personalized blood glucose monitor based on smartphone that works without CGM data as long-term input.
  It automatically collects daily exercise and sleep quality, and infers the current blood glucose level of users,  together with manual records of food, drug and insulin intake.
  \item
  We propose \modelname, an efficient multi-division deep dynamic RNN framework on blood glucose level inference.
  It is able to \emph{(i)} depict complex dynamics via deep dynamic layers, \emph{(ii)} extract group-distinct feature representations via grouped input layers, and \emph{(iii)} preserve user-specific characteristics via the personalized output layer.
  It tackles the typical sparsity and imbalance problems in datasets for blood glucse modeling and offers an opportunity to build blood glucose models for the general public based on limited personal measurements from single-user and grouped-users views. \TODO{do not sell the whole architecture}
  \item
  \rev{We conduct extensive evaluations on both diabetic patients and non-diabetic people.
  Experimental results from a dataset that covers 35 non-diabetic people, 38 type I and 39 type II diabetic patients and each person is measured at least 6 days, demonstrating that \sysname yields an average accuracy of 82.14\%, and outperforms traditional general learning, group-level learning, personalized learning and shallow/deep learning algorithms in precision and recall.}
\end{itemize}

In the rest of this paper, we review related works in \secref{sec:relwork} and present an overview of \sysname in \secref{sec:overview}.
The design and evaluation of \sysname are detailed in \secref{sec:design} and \secref{sec:eval}, respectively.
Finally, we conclude in \secref{sec:conclusion}.

